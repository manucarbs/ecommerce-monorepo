<div id="home-screen" class="app-screen">
  <div class="top-header">
    <div class="logo-text">E-COMMERCE</div>
  </div>

  <!-- Buscador -->
  <section class="search-container">
    <input
      class="search-bar"
      [placeholder]="searchPlaceholder"
      [value]="searchTerm()"
      (input)="onSearch($event.target.value)"
      aria-label="Buscar productos"
    />
  </section>

  <!-- Contenido desplazable -->
  <main class="main-content">
    <!-- CategorÃ­as dinÃ¡micas -->
    <h2 class="section-title">â­ CategorÃ­as</h2>

    <div class="category-grid" role="list">
      <!-- BotÃ³n "Todas" -->
      <button
        class="category-item"
        role="listitem"
        type="button"
        aria-label="Todas las categorÃ­as"
        (click)="selectCategory(null)"
        [class.active]="selectedCategory() === null"
      >
        <div class="category-circle">T</div>
        <span>Todas</span>
      </button>

      <!-- CategorÃ­as desde API -->
      @for (c of categories(); track c) {
        <button
          class="category-item"
          role="listitem"
          type="button"
          aria-label="CategorÃ­a {{ c }}"
          (click)="selectCategory(c)"
          [class.active]="selectedCategory() === c"
        >
          <div class="category-circle">{{ c[0]?.toUpperCase() }}</div>
          <span>{{ c }}</span>
        </button>
      }
    </div>


    <h2 class="section-title">âœ¨ Ãšltimas Novedades</h2>

    @if (cargando()) {
      <div class="state">Cargandoâ€¦</div>
    } @else if (errorMsg()) {
      <div class="state error">{{ errorMsg() }}</div>
    } @else {
      <div class="product-grid">
        @if (filteredProducts().length > 0) {
          @for (p of filteredProducts(); track p.id) {
            <app-product-card
              [imageSrc]="getImagen(p)"
              [imageAlt]="p.titulo"
              [title]="p.titulo"
              [description]="p.descripcion"
              [price]="p.precio"
              currency="USD"
              [category]="p.categoria"
              (cardClick)="openProduct(p)"
            >
            </app-product-card>
          }
        } @else {
          <div class="state">Producto no fue encontrado.</div>
        }
      </div>
    }

    <div class="spacer"></div>
  </main>
</div>

<div class="nav-bar">
  <div class="nav-item" [class.active]="activeTab() === 'home'">
    <div class="nav-icon">ğŸ </div>
    Home
  </div>
  <div class="nav-item" [class.active]="activeTab() === 'sell'">
    <div class="nav-icon" (click)="goToSell()">ğŸ·ï¸</div>
    Vender
  </div>
  <div class="nav-item" [class.active]="activeTab() === 'fav'">
    <div class="nav-icon">â¤ï¸</div>
    Favoritos
  </div>
  <div class="nav-item" [class.active]="activeTab() === 'cart'">
    <div class="nav-icon">ğŸ›’</div>
    Carrito
  </div>
  <div class="nav-item" [class.active]="activeTab() === 'profile'">
    <div class="nav-icon">ğŸ‘¤</div>
    Perfil
  </div>
  <div class="nav-item" [class.active]="activeTab() === 'profile'"
    (click)="logout()">
    <div class="nav-icon">ğŸš¶</div>
    Cerrar sesiÃ³n
  </div>
</div>
