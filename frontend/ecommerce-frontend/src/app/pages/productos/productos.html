<div id="home-screen" class="app-screen">
  <!-- Header -->
  <header class="top-header">
    <h1 class="logo-text">E-COMMERCE</h1>
  </header>

  <!-- Buscador -->
  <section class="search-container">
    <input
      type="search"
      class="search-bar"
      [placeholder]="searchPlaceholder"
      [value]="searchTerm()"
      (input)="onSearch($event.target.value)"
      aria-label="Buscar productos"
    />
  </section>

  <!-- Contenido principal desplazable -->
  <main class="main-content">
    <!-- SecciÃ³n de CategorÃ­as -->
    <section class="categories-section">
      <h2 class="section-title">â­ CategorÃ­as</h2>
      
      <div class="category-grid" role="list">
        <!-- BotÃ³n "Todas" -->
        <button
          class="category-item"
          role="listitem"
          type="button"
          aria-label="Todas las categorÃ­as"
          (click)="selectCategory(null)"
          [class.active]="selectedCategory() === null"
        >
          <div class="category-circle">T</div>
          <span>Todas</span>
        </button>

        <!-- CategorÃ­as desde API -->
        @for (c of categories(); track c) {
          <button
            class="category-item"
            role="listitem"
            type="button"
            [attr.aria-label]="'CategorÃ­a ' + c"
            (click)="selectCategory(c)"
            [class.active]="selectedCategory() === c"
          >
            <div class="category-circle">{{ c[0]?.toUpperCase() }}</div>
            <span>{{ c }}</span>
          </button>
        }
      </div>
    </section>

    <!-- SecciÃ³n de Productos -->
    <section class="products-section">
      <h2 class="section-title">âœ¨ Ãšltimas Novedades</h2>

      <!-- Estados de carga -->
      @if (cargando()) {
        <div class="state" role="status" aria-live="polite">
          <span>Cargando productos...</span>
        </div>
      } @else if (errorMsg()) {
        <div class="state error" role="alert">
          {{ errorMsg() }}
        </div>
      } @else {
        <!-- Grid de productos -->
        <div class="product-grid">
          @if (filteredProducts().length > 0) {
            @for (p of filteredProducts(); track p.id) {
              <app-product-card
                [imageSrc]="getImagen(p)"
                [imageAlt]="p.titulo || 'Producto sin tÃ­tulo'"
                [title]="p.titulo || 'Sin tÃ­tulo'"
                [description]="p.descripcion || ''"
                [price]="p.precio || '0'"
                currency="USD"
                [category]="p.categoria || ''"
                (cardClick)="openProduct(p)"
              />
            }
          } @else {
            <div class="state">
              No se encontraron productos para tu bÃºsqueda.
            </div>
          }
        </div>
      }
    </section>

    <!-- Espaciador para scroll -->
    <div class="spacer"></div>
  </main>

  <!-- Barra de navegaciÃ³n inferior -->
  <nav class="nav-bar" role="navigation" aria-label="NavegaciÃ³n principal">
    <button 
      class="nav-item" 
      type="button"
      [class.active]="activeTab() === 'home'"
      aria-label="Ir a inicio"
    >
      <div class="nav-icon" aria-hidden="true">ğŸ </div>
      <span>Home</span>
    </button>

    <button 
      class="nav-item" 
      type="button"
      [class.active]="activeTab() === 'sell'"
      (click)="goToSell()"
      aria-label="Vender productos"
    >
      <div class="nav-icon" aria-hidden="true">ğŸ·ï¸</div>
      <span>Vender</span>
    </button>

    <button 
      class="nav-item" 
      type="button"
      [class.active]="activeTab() === 'fav'"
      aria-label="Ver favoritos"
    >
      <div class="nav-icon" aria-hidden="true">â¤ï¸</div>
      <span>Favoritos</span>
    </button>

    <button 
      class="nav-item" 
      type="button"
      [class.active]="activeTab() === 'cart'"
      aria-label="Ver carrito de compras"
    >
      <div class="nav-icon" aria-hidden="true">ğŸ›’</div>
      <span>Carrito</span>
    </button>

    <button 
      class="nav-item" 
      type="button"
      [class.active]="activeTab() === 'profile'"
      aria-label="Ver perfil"
    >
      <div class="nav-icon" aria-hidden="true">ğŸ‘¤</div>
      <span>Perfil</span>
    </button>

    <button 
      class="nav-item" 
      type="button"
      (click)="logout()"
      aria-label="Cerrar sesiÃ³n"
    >
      <div class="nav-icon" aria-hidden="true">ğŸšª</div>
      <span>Salir</span>
    </button>
  </nav>
</div>