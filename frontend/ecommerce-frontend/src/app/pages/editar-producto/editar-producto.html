<div class="container" *ngIf="!cargando(); else cargandoTpl">
  <h2>ğŸ› ï¸ Editar producto</h2>

  <div *ngIf="errorMsg(); else formTpl" class="error">
    {{ errorMsg() }}
  </div>

  <ng-template #formTpl>
    <form (ngSubmit)="guardarCambios()" *ngIf="producto() as p">
      <label>TÃ­tulo</label>
      <input type="text" [(ngModel)]="p.titulo" name="titulo" required />

      <label>DescripciÃ³n</label>
      <textarea [(ngModel)]="p.descripcion" name="descripcion" rows="4"></textarea>

      <label>Precio</label>
      <input type="number" [(ngModel)]="p.precio" name="precio" min="0" required />

      <h3>ğŸ–¼ï¸ ImÃ¡genes actuales</h3>
      <div class="galeria">
        <div *ngFor="let img of p.imagenesUrl; let i = index" class="imagen-item">
          <img [src]="img" alt="Imagen del producto" />
          <button type="button" (click)="eliminarImagenActual(i)" title="Eliminar">âŒ</button>
        </div>
      </div>

      <label for="nuevas">Agregar nuevas imÃ¡genes (mÃ¡x. 5)</label>
      <input type="file" id="nuevas" (change)="onFileSelected($event)" multiple accept="image/*" />

      <div class="galeria">
        <div *ngFor="let preview of previewUrls(); let i = index" class="imagen-item preview">
          <img [src]="preview" alt="Preview" />
          <button type="button" (click)="removePreview(i)" title="Quitar">ğŸ—‘ï¸</button>
        </div>
      </div>

      <p *ngIf="errorMsg()" class="error-msg">{{ errorMsg() }}</p>
      <p *ngIf="progresoUpload()" class="upload-msg">{{ progresoUpload() }}</p>

      <div class="botones">
        <button type="submit" [disabled]="guardando()">ğŸ’¾ Guardar cambios</button>
        <button type="button" (click)="cancelar()">â†©ï¸ Cancelar</button>
      </div>
    </form>
  </ng-template>
</div>

<ng-template #cargandoTpl>
  <div class="loading">Cargando producto...</div>
</ng-template>
